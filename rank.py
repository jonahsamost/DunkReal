import subprocess
from openai import OpenAI
import os
from dotenv import load_dotenv
import datetime
import json


load_dotenv()

client = OpenAI(
    api_key=os.getenv("OPENAI_API_KEY"),
)


def chunk_audio(filePath):
    # take a 10 minute video
    # chunk that to 10 seconds blocks
    # Whisper and return an object with
    # {
    #   start: timestamp (relative to the start of the whole video)
    #   end: timestamp (relative to the start of the whole video)
    #   text: transcript
    # }
    #
    output_file_paths = []

    # Get the duration of the audio file in seconds
    command = f'ffprobe -v error -show_entries format=duration -of default=noprint_wrappers=1:nokey=1 {filePath}'
    result = subprocess.run(command.split(), stdout=subprocess.PIPE)
    duration = int(float(result.stdout))

    # Calculate the number of chunks based on the duration
    num_chunks = duration // 10
    if duration % 10 != 0:
        num_chunks += 1

    # Chunk the audio file
    for i in range(num_chunks):
        start_time = str(datetime.timedelta(seconds=i*10))
        end_time = str(datetime.timedelta(seconds=(i+1)*10))
        command = f'ffmpeg -ss {start_time} -to {end_time} -i ../files/warriors.mp3 -c copy ../files/chunk_{start_time.replace(":","_")}.mp3'
        subprocess.run(command.split())
        output_file_path = f'../files/chunk_{start_time.replace(":","_")}.mp3'
        output_file_paths.append(output_file_path)

    return output_file_paths

sampleChunks = ['../files/chunk_0_00_00.mp3', '../files/chunk_0_00_10.mp3', '../files/chunk_0_00_20.mp3', '../files/chunk_0_00_30.mp3', '../files/chunk_0_00_40.mp3', '../files/chunk_0_00_50.mp3', '../files/chunk_0_01_00.mp3', '../files/chunk_0_01_10.mp3', '../files/chunk_0_01_20.mp3', '../files/chunk_0_01_30.mp3', '../files/chunk_0_01_40.mp3', '../files/chunk_0_01_50.mp3', '../files/chunk_0_02_00.mp3', '../files/chunk_0_02_10.mp3', '../files/chunk_0_02_20.mp3', '../files/chunk_0_02_30.mp3', '../files/chunk_0_02_40.mp3', '../files/chunk_0_02_50.mp3', '../files/chunk_0_03_00.mp3', '../files/chunk_0_03_10.mp3', '../files/chunk_0_03_20.mp3', '../files/chunk_0_03_30.mp3', '../files/chunk_0_03_40.mp3', '../files/chunk_0_03_50.mp3', '../files/chunk_0_04_00.mp3', '../files/chunk_0_04_10.mp3', '../files/chunk_0_04_20.mp3', '../files/chunk_0_04_30.mp3', '../files/chunk_0_04_40.mp3', '../files/chunk_0_04_50.mp3', '../files/chunk_0_05_00.mp3', '../files/chunk_0_05_10.mp3', '../files/chunk_0_05_20.mp3', '../files/chunk_0_05_30.mp3', '../files/chunk_0_05_40.mp3', '../files/chunk_0_05_50.mp3', '../files/chunk_0_06_00.mp3', '../files/chunk_0_06_10.mp3', '../files/chunk_0_06_20.mp3', '../files/chunk_0_06_30.mp3', '../files/chunk_0_06_40.mp3', '../files/chunk_0_06_50.mp3', '../files/chunk_0_07_00.mp3', '../files/chunk_0_07_10.mp3', '../files/chunk_0_07_20.mp3', '../files/chunk_0_07_30.mp3', '../files/chunk_0_07_40.mp3', '../files/chunk_0_07_50.mp3', '../files/chunk_0_08_00.mp3', '../files/chunk_0_08_10.mp3', '../files/chunk_0_08_20.mp3', '../files/chunk_0_08_30.mp3', '../files/chunk_0_08_40.mp3', '../files/chunk_0_08_50.mp3', '../files/chunk_0_09_00.mp3', '../files/chunk_0_09_10.mp3', '../files/chunk_0_09_20.mp3', '../files/chunk_0_09_30.mp3', '../files/chunk_0_09_40.mp3', '../files/chunk_0_09_50.mp3']

oneChunk = 'files/500s_output.mp3'

sampleSegments = [{'id': 0, 'seek': 0, 'start': 0.0, 'end': 5.68, 'text': ' season but both finished up the regular season strong the Lakers ended with a five game winning', 'tokens': [50364, 3196, 457, 1293, 4335, 493, 264, 3890, 3196, 2068, 264, 441, 19552, 4590, 365, 257, 1732, 1216, 8224, 50648], 'temperature': 0.0, 'avg_logprob': -0.24738168155445772, 'compression_ratio': 1.7072072072072073, 'no_speech_prob': 0.006385989021509886}, {'id': 1, 'seek': 0, 'start': 5.68, 'end': 12.4, 'text': ' streak and the Warriors ended with a six game winning streak watch out James again with that', 'tokens': [50648, 35634, 293, 264, 40161, 4590, 365, 257, 2309, 1216, 8224, 35634, 1159, 484, 5678, 797, 365, 300, 50984], 'temperature': 0.0, 'avg_logprob': -0.24738168155445772, 'compression_ratio': 1.7072072072072073, 'no_speech_prob': 0.006385989021509886}, {'id': 2, 'seek': 0, 'start': 12.4, 'end': 18.32, 'text': ' right ankle he played last couple of games did tweak it on Sunday but he played very well in', 'tokens': [50984, 558, 21999, 415, 3737, 1036, 1916, 295, 2813, 630, 29879, 309, 322, 7776, 457, 415, 3737, 588, 731, 294, 51280], 'temperature': 0.0, 'avg_logprob': -0.24738168155445772, 'compression_ratio': 1.7072072072072073, 'no_speech_prob': 0.006385989021509886}, {'id': 3, 'seek': 0, 'start': 18.32, 'end': 24.0, 'text': " those final two games and here's one of the fun matchups in this series Anthony Davis has to take", 'tokens': [51280, 729, 2572, 732, 2813, 293, 510, 311, 472, 295, 264, 1019, 2995, 7528, 294, 341, 2638, 15853, 15658, 575, 281, 747, 51564], 'temperature': 0.0, 'avg_logprob': -0.24738168155445772, 'compression_ratio': 1.7072072072072073, 'no_speech_prob': 0.006385989021509886}, {'id': 4, 'seek': 2400, 'start': 24.0, 'end': 33.28, 'text': ' a tough shot well defended by Draymond Green obviously both teams would love to get the win', 'tokens': [50364, 257, 4930, 3347, 731, 34135, 538, 2491, 320, 12171, 6969, 2745, 1293, 5491, 576, 959, 281, 483, 264, 1942, 50828], 'temperature': 0.0, 'avg_logprob': -0.18411335046740546, 'compression_ratio': 1.4739583333333333, 'no_speech_prob': 0.1776885688304901}, {'id': 5, 'seek': 2400, 'start': 33.28, 'end': 37.84, 'text': ' tonight and give it a little extra time to heal and prepare for their opponent as Andrew Wiggins', 'tokens': [50828, 4440, 293, 976, 309, 257, 707, 2857, 565, 281, 10526, 293, 5940, 337, 641, 10620, 382, 10110, 343, 6249, 1292, 51056], 'temperature': 0.0, 'avg_logprob': -0.18411335046740546, 'compression_ratio': 1.4739583333333333, 'no_speech_prob': 0.1776885688304901}, {'id': 6, 'seek': 2400, 'start': 37.84, 'end': 45.68, 'text': " gets inside and gets the bucket to me he's the key they need 25 from him tonight to be able to", 'tokens': [51056, 2170, 1854, 293, 2170, 264, 13058, 281, 385, 415, 311, 264, 2141, 436, 643, 3552, 490, 796, 4440, 281, 312, 1075, 281, 51448], 'temperature': 0.0, 'avg_logprob': -0.18411335046740546, 'compression_ratio': 1.4739583333333333, 'no_speech_prob': 0.1776885688304901}, {'id': 7, 'seek': 4568, 'start': 45.68, 'end': 53.68, 'text': ' score enough to win Schroeder nice play and drumming well a big flush down the other end', 'tokens': [50364, 6175, 1547, 281, 1942, 2065, 340, 10020, 1481, 862, 293, 10206, 2810, 731, 257, 955, 19568, 760, 264, 661, 917, 50764], 'temperature': 0.0, 'avg_logprob': -0.26411895751953124, 'compression_ratio': 1.6177777777777778, 'no_speech_prob': 0.49195748567581177}, {'id': 8, 'seek': 4568, 'start': 53.68, 'end': 57.92, 'text': " and that's a welcome sight for Laker fans it's not Anthony Davis and LeBron James", 'tokens': [50764, 293, 300, 311, 257, 2928, 7860, 337, 441, 4003, 4499, 309, 311, 406, 15853, 15658, 293, 1456, 33, 2044, 5678, 50976], 'temperature': 0.0, 'avg_logprob': -0.26411895751953124, 'compression_ratio': 1.6177777777777778, 'no_speech_prob': 0.49195748567581177}, {'id': 9, 'seek': 4568, 'start': 57.92, 'end': 62.72, 'text': ' making every play but you get Schroeder making plays for Drummond they can be dangerous', 'tokens': [50976, 1455, 633, 862, 457, 291, 483, 2065, 340, 10020, 1455, 5749, 337, 40320, 12171, 436, 393, 312, 5795, 51216], 'temperature': 0.0, 'avg_logprob': -0.26411895751953124, 'compression_ratio': 1.6177777777777778, 'no_speech_prob': 0.49195748567581177}, {'id': 10, 'seek': 4568, 'start': 63.44, 'end': 65.52, 'text': " Ken Batesmar for three that's good", 'tokens': [51252, 8273, 363, 1024, 6209, 337, 1045, 300, 311, 665, 51356], 'temperature': 0.0, 'avg_logprob': -0.26411895751953124, 'compression_ratio': 1.6177777777777778, 'no_speech_prob': 0.49195748567581177}, {'id': 11, 'seek': 4568, 'start': 68.08, 'end': 71.2, 'text': " you know Steve Kerr talking before the game knows it's a taunting task", 'tokens': [51484, 291, 458, 7466, 20706, 81, 1417, 949, 264, 1216, 3255, 309, 311, 257, 1846, 14559, 5633, 51640], 'temperature': 0.0, 'avg_logprob': -0.26411895751953124, 'compression_ratio': 1.6177777777777778, 'no_speech_prob': 0.49195748567581177}, {'id': 12, 'seek': 7120, 'start': 71.84, 'end': 76.88, 'text': " against a Laker team when healthy they're as good as anybody in the league but he also knows", 'tokens': [50396, 1970, 257, 441, 4003, 1469, 562, 4627, 436, 434, 382, 665, 382, 4472, 294, 264, 14957, 457, 415, 611, 3255, 50648], 'temperature': 0.0, 'avg_logprob': -0.18930389881134033, 'compression_ratio': 1.4851485148514851, 'no_speech_prob': 0.010327094234526157}, {'id': 13, 'seek': 7120, 'start': 76.88, 'end': 82.32000000000001, 'text': " just one game that's all you have to win this is not a playoff series it's a one game and move on", 'tokens': [50648, 445, 472, 1216, 300, 311, 439, 291, 362, 281, 1942, 341, 307, 406, 257, 862, 4506, 2638, 309, 311, 257, 472, 1216, 293, 1286, 322, 50920], 'temperature': 0.0, 'avg_logprob': -0.18930389881134033, 'compression_ratio': 1.4851485148514851, 'no_speech_prob': 0.010327094234526157}, {'id': 14, 'seek': 7120, 'start': 84.56, 'end': 88.48, 'text': " Schroeder's jumper ball tipped and taken by Draymond Green", 'tokens': [51032, 2065, 340, 10020, 311, 44061, 2594, 256, 5529, 293, 2726, 538, 2491, 320, 12171, 6969, 51228], 'temperature': 0.0, 'avg_logprob': -0.18930389881134033, 'compression_ratio': 1.4851485148514851, 'no_speech_prob': 0.010327094234526157}, {'id': 15, 'seek': 7120, 'start': 93.60000000000001, 'end': 96.96000000000001, 'text': ' on the season Warriors 39 and 33 but they finished', 'tokens': [51484, 322, 264, 3196, 40161, 15238, 293, 11816, 457, 436, 4335, 51652], 'temperature': 0.0, 'avg_logprob': -0.18930389881134033, 'compression_ratio': 1.4851485148514851, 'no_speech_prob': 0.010327094234526157}, {'id': 16, 'seek': 9696, 'start': 97.91999999999999, 'end': 103.11999999999999, 'text': ' winning 15 of their final 20 games in the regular season just great basketball as Wiggins', 'tokens': [50412, 8224, 2119, 295, 641, 2572, 945, 2813, 294, 264, 3890, 3196, 445, 869, 11767, 382, 343, 6249, 1292, 50672], 'temperature': 0.0, 'avg_logprob': -0.1626431941986084, 'compression_ratio': 1.4979253112033195, 'no_speech_prob': 0.00232297508046031}, {'id': 17, 'seek': 9696, 'start': 103.75999999999999, 'end': 106.96, 'text': " knocks down another and he's playing with a lot more confidence look at that he didn't", 'tokens': [50704, 40815, 760, 1071, 293, 415, 311, 2433, 365, 257, 688, 544, 6687, 574, 412, 300, 415, 994, 380, 50864], 'temperature': 0.0, 'avg_logprob': -0.1626431941986084, 'compression_ratio': 1.4979253112033195, 'no_speech_prob': 0.00232297508046031}, {'id': 18, 'seek': 9696, 'start': 106.96, 'end': 111.11999999999999, 'text': ' wait for Steph Curry to make a play waved everybody out of the way and took advantage', 'tokens': [50864, 1699, 337, 31418, 34789, 281, 652, 257, 862, 261, 12865, 2201, 484, 295, 264, 636, 293, 1890, 5002, 51072], 'temperature': 0.0, 'avg_logprob': -0.1626431941986084, 'compression_ratio': 1.4979253112033195, 'no_speech_prob': 0.00232297508046031}, {'id': 19, 'seek': 9696, 'start': 111.11999999999999, 'end': 117.28, 'text': ' of his matchup James to Davis Davis goes right at Draymond Green again well defended Davis thought', 'tokens': [51072, 295, 702, 2995, 1010, 5678, 281, 15658, 15658, 1709, 558, 412, 2491, 320, 12171, 6969, 797, 731, 34135, 15658, 1194, 51380], 'temperature': 0.0, 'avg_logprob': -0.1626431941986084, 'compression_ratio': 1.4979253112033195, 'no_speech_prob': 0.00232297508046031}, {'id': 20, 'seek': 11728, 'start': 117.28, 'end': 128.0, 'text': ' he was hit Lakers have not been dominant at home this season clearly a lot of that had to do with', 'tokens': [50364, 415, 390, 2045, 441, 19552, 362, 406, 668, 15657, 412, 1280, 341, 3196, 4448, 257, 688, 295, 300, 632, 281, 360, 365, 50900], 'temperature': 0.0, 'avg_logprob': -0.2276787113498997, 'compression_ratio': 1.5235602094240839, 'no_speech_prob': 0.05339379608631134}, {'id': 21, 'seek': 11728, 'start': 128.0, 'end': 134.24, 'text': ' missing the two players as Curry pulls back but despite all the misses as Draymond Green kicks', 'tokens': [50900, 5361, 264, 732, 4150, 382, 34789, 16982, 646, 457, 7228, 439, 264, 29394, 382, 2491, 320, 12171, 6969, 21293, 51212], 'temperature': 0.0, 'avg_logprob': -0.2276787113498997, 'compression_ratio': 1.5235602094240839, 'no_speech_prob': 0.05339379608631134}, {'id': 22, 'seek': 11728, 'start': 134.24, 'end': 140.08, 'text': ' it out to Batesmore and Batesmore from the elbow jumper way off Looney has to throw it up then hit', 'tokens': [51212, 309, 484, 281, 363, 1024, 3138, 293, 363, 1024, 3138, 490, 264, 18507, 44061, 636, 766, 6130, 1308, 575, 281, 3507, 309, 493, 550, 2045, 51504], 'temperature': 0.0, 'avg_logprob': -0.2276787113498997, 'compression_ratio': 1.5235602094240839, 'no_speech_prob': 0.05339379608631134}, {'id': 23, 'seek': 14008, 'start': 140.08, 'end': 144.64000000000001, 'text': ' the rim and it goes in Kavon Looney very aware of the shot clock about to expire', 'tokens': [50364, 264, 15982, 293, 309, 1709, 294, 591, 706, 266, 6130, 1308, 588, 3650, 295, 264, 3347, 7830, 466, 281, 45447, 50592], 'temperature': 0.0, 'avg_logprob': -0.22528300565831802, 'compression_ratio': 1.6147186147186148, 'no_speech_prob': 0.011153546161949635}, {'id': 24, 'seek': 14008, 'start': 148.08, 'end': 153.52, 'text': ' but Jeff you talked about without Anthony Davis and LeBron James you were impressed as Schroeder', 'tokens': [50764, 457, 7506, 291, 2825, 466, 1553, 15853, 15658, 293, 1456, 33, 2044, 5678, 291, 645, 11679, 382, 2065, 340, 10020, 51036], 'temperature': 0.0, 'avg_logprob': -0.22528300565831802, 'compression_ratio': 1.6147186147186148, 'no_speech_prob': 0.011153546161949635}, {'id': 25, 'seek': 14008, 'start': 153.52, 'end': 159.68, 'text': ' misses impressed the way the Lakers kept being competitive absolutely defensively they remained', 'tokens': [51036, 29394, 11679, 264, 636, 264, 441, 19552, 4305, 885, 10043, 3122, 16468, 356, 436, 12780, 51344], 'temperature': 0.0, 'avg_logprob': -0.22528300565831802, 'compression_ratio': 1.6147186147186148, 'no_speech_prob': 0.011153546161949635}, {'id': 26, 'seek': 14008, 'start': 159.68, 'end': 166.08, 'text': " rock solid they just had some troubles offensively but what they've done defensively all year to be", 'tokens': [51344, 3727, 5100, 436, 445, 632, 512, 15379, 15710, 356, 457, 437, 436, 600, 1096, 16468, 356, 439, 1064, 281, 312, 51664], 'temperature': 0.0, 'avg_logprob': -0.22528300565831802, 'compression_ratio': 1.6147186147186148, 'no_speech_prob': 0.011153546161949635}, {'id': 27, 'seek': 16608, 'start': 166.08, 'end': 173.92000000000002, 'text': ' the best team in the league at that end is special Curry throws the pass stolen by Anthony', 'tokens': [50364, 264, 1151, 1469, 294, 264, 14957, 412, 300, 917, 307, 2121, 34789, 19251, 264, 1320, 15900, 538, 15853, 50756], 'temperature': 0.0, 'avg_logprob': -0.1938374078095849, 'compression_ratio': 1.5376344086021505, 'no_speech_prob': 0.007344984915107489}, {'id': 28, 'seek': 16608, 'start': 173.92000000000002, 'end': 181.84, 'text': " Davis and number one rated defensive team Davis for three rebound kept alive by Drummond but he's", 'tokens': [50756, 15658, 293, 1230, 472, 22103, 16468, 1469, 15658, 337, 1045, 31850, 4305, 5465, 538, 40320, 12171, 457, 415, 311, 51152], 'temperature': 0.0, 'avg_logprob': -0.1938374078095849, 'compression_ratio': 1.5376344086021505, 'no_speech_prob': 0.007344984915107489}, {'id': 29, 'seek': 16608, 'start': 181.84, 'end': 189.84, 'text': ' going to be called for a loose ball foul Andre Drummond signed at the end of March after a buyout', 'tokens': [51152, 516, 281, 312, 1219, 337, 257, 9612, 2594, 23491, 20667, 40320, 12171, 8175, 412, 264, 917, 295, 6129, 934, 257, 2256, 346, 51552], 'temperature': 0.0, 'avg_logprob': -0.1938374078095849, 'compression_ratio': 1.5376344086021505, 'no_speech_prob': 0.007344984915107489}, {'id': 30, 'seek': 18984, 'start': 190.8, 'end': 198.32, 'text': ' with the Cavaliers this is his 22nd game started all 21 games average just under 12 points a little', 'tokens': [50412, 365, 264, 28066, 304, 4890, 341, 307, 702, 5853, 273, 1216, 1409, 439, 5080, 2813, 4274, 445, 833, 2272, 2793, 257, 707, 50788], 'temperature': 0.0, 'avg_logprob': -0.3194084817712957, 'compression_ratio': 1.5737704918032787, 'no_speech_prob': 0.0022517021279782057}, {'id': 31, 'seek': 18984, 'start': 198.32, 'end': 203.6, 'text': ' over 10 rebounds but Frank Vogel says still a work in progress trying to get him comfortable', 'tokens': [50788, 670, 1266, 12970, 4432, 457, 6823, 46359, 338, 1619, 920, 257, 589, 294, 4205, 1382, 281, 483, 796, 4619, 51052], 'temperature': 0.0, 'avg_logprob': -0.3194084817712957, 'compression_ratio': 1.5737704918032787, 'no_speech_prob': 0.0022517021279782057}, {'id': 32, 'seek': 18984, 'start': 203.6, 'end': 212.24, 'text': ' and familiar with playing with his new teammates Curry to Looney Curry using a dream on green', 'tokens': [51052, 293, 4963, 365, 2433, 365, 702, 777, 20461, 34789, 281, 6130, 1308, 34789, 1228, 257, 3055, 322, 3092, 51484], 'temperature': 0.0, 'avg_logprob': -0.3194084817712957, 'compression_ratio': 1.5737704918032787, 'no_speech_prob': 0.0022517021279782057}, {'id': 33, 'seek': 18984, 'start': 212.24, 'end': 218.88, 'text': ' screen nice feet inside Looney shot blocked Andre Drummond with the rejection Looney was ready to', 'tokens': [51484, 2568, 1481, 3521, 1854, 6130, 1308, 3347, 15470, 20667, 40320, 12171, 365, 264, 26044, 6130, 1308, 390, 1919, 281, 51816], 'temperature': 0.0, 'avg_logprob': -0.3194084817712957, 'compression_ratio': 1.5737704918032787, 'no_speech_prob': 0.0022517021279782057}, {'id': 34, 'seek': 21888, 'start': 219.28, 'end': 226.64, 'text': " throw it down James to Davis James with the tip in with the left hand and Frank Vogel's", 'tokens': [50384, 3507, 309, 760, 5678, 281, 15658, 5678, 365, 264, 4125, 294, 365, 264, 1411, 1011, 293, 6823, 46359, 338, 311, 50752], 'temperature': 0.0, 'avg_logprob': -0.22929632341539538, 'compression_ratio': 1.521978021978022, 'no_speech_prob': 0.008708950132131577}, {'id': 35, 'seek': 21888, 'start': 226.64, 'end': 230.79999999999998, 'text': ' irate he thought David Davis got fouled again I thought it was a good block', 'tokens': [50752, 3418, 473, 415, 1194, 4389, 15658, 658, 32012, 1493, 797, 286, 1194, 309, 390, 257, 665, 3461, 50960], 'temperature': 0.0, 'avg_logprob': -0.22929632341539538, 'compression_ratio': 1.521978021978022, 'no_speech_prob': 0.008708950132131577}, {'id': 36, 'seek': 21888, 'start': 234.4, 'end': 239.28, 'text': ' Curry flips it up shot too strong Looney back out to Bazemore wide open three', 'tokens': [51140, 34789, 40249, 309, 493, 3347, 886, 2068, 6130, 1308, 646, 484, 281, 42220, 443, 418, 4874, 1269, 1045, 51384], 'temperature': 0.0, 'avg_logprob': -0.22929632341539538, 'compression_ratio': 1.521978021978022, 'no_speech_prob': 0.008708950132131577}, {'id': 37, 'seek': 21888, 'start': 242.07999999999998, 'end': 244.56, 'text': ' and Vogel wants a timeout hot start', 'tokens': [51524, 293, 46359, 338, 2738, 257, 565, 346, 2368, 722, 51648], 'temperature': 0.0, 'avg_logprob': -0.22929632341539538, 'compression_ratio': 1.521978021978022, 'no_speech_prob': 0.008708950132131577}, {'id': 38, 'seek': 24456, 'start': 245.52, 'end': 249.84, 'text': " such so many different matchups to look at have fun let's let's start with Steph Curry Jeff", 'tokens': [50412, 1270, 370, 867, 819, 2995, 7528, 281, 574, 412, 362, 1019, 718, 311, 718, 311, 722, 365, 31418, 34789, 7506, 50628], 'temperature': 0.0, 'avg_logprob': -0.19602312865080657, 'compression_ratio': 1.6779026217228465, 'no_speech_prob': 0.016648562625050545}, {'id': 39, 'seek': 24456, 'start': 250.56, 'end': 254.16, 'text': ' how do the Lakers try and guard him what do you think their their game plan will be', 'tokens': [50664, 577, 360, 264, 441, 19552, 853, 293, 6290, 796, 437, 360, 291, 519, 641, 641, 1216, 1393, 486, 312, 50844], 'temperature': 0.0, 'avg_logprob': -0.19602312865080657, 'compression_ratio': 1.6779026217228465, 'no_speech_prob': 0.016648562625050545}, {'id': 40, 'seek': 24456, 'start': 255.04, 'end': 259.28000000000003, 'text': ' well the thing I think for a great defensive team like the Lakers that they have to avoid', 'tokens': [50888, 731, 264, 551, 286, 519, 337, 257, 869, 16468, 1469, 411, 264, 441, 19552, 300, 436, 362, 281, 5042, 51100], 'temperature': 0.0, 'avg_logprob': -0.19602312865080657, 'compression_ratio': 1.6779026217228465, 'no_speech_prob': 0.016648562625050545}, {'id': 41, 'seek': 24456, 'start': 259.28000000000003, 'end': 264.96, 'text': " is overreacting to Curry and leaving others open that's what's happened to start this game", 'tokens': [51100, 307, 670, 265, 41090, 281, 34789, 293, 5012, 2357, 1269, 300, 311, 437, 311, 2011, 281, 722, 341, 1216, 51384], 'temperature': 0.0, 'avg_logprob': -0.19602312865080657, 'compression_ratio': 1.6779026217228465, 'no_speech_prob': 0.016648562625050545}, {'id': 42, 'seek': 24456, 'start': 266.72, 'end': 272.16, 'text': " meanwhile Mark a big question for Frank Vogel and the Lakers they've got the size advantage", 'tokens': [51472, 29252, 3934, 257, 955, 1168, 337, 6823, 46359, 338, 293, 264, 441, 19552, 436, 600, 658, 264, 2744, 5002, 51744], 'temperature': 0.0, 'avg_logprob': -0.19602312865080657, 'compression_ratio': 1.6779026217228465, 'no_speech_prob': 0.016648562625050545}, {'id': 43, 'seek': 27216, 'start': 272.24, 'end': 276.40000000000003, 'text': " they've got the traditional centers Golden State likes to play small ball how do you handle that", 'tokens': [50368, 436, 600, 658, 264, 5164, 10898, 13410, 4533, 5902, 281, 862, 1359, 2594, 577, 360, 291, 4813, 300, 50576], 'temperature': 0.0, 'avg_logprob': -0.23166833482347093, 'compression_ratio': 1.6453900709219857, 'no_speech_prob': 0.003945052158087492}, {'id': 44, 'seek': 27216, 'start': 276.40000000000003, 'end': 282.48, 'text': " if you're Frank Vogel well to me I like to see him post up LeBron James against a smaller Wiggins", 'tokens': [50576, 498, 291, 434, 6823, 46359, 338, 731, 281, 385, 286, 411, 281, 536, 796, 2183, 493, 1456, 33, 2044, 5678, 1970, 257, 4356, 343, 6249, 1292, 50880], 'temperature': 0.0, 'avg_logprob': -0.23166833482347093, 'compression_ratio': 1.6453900709219857, 'no_speech_prob': 0.003945052158087492}, {'id': 45, 'seek': 27216, 'start': 282.48, 'end': 286.8, 'text': ' or last possessing Bazemore defending him take advantage of that size and strength creating', 'tokens': [50880, 420, 1036, 17490, 278, 42220, 443, 418, 21377, 796, 747, 5002, 295, 300, 2744, 293, 3800, 4084, 51096], 'temperature': 0.0, 'avg_logprob': -0.23166833482347093, 'compression_ratio': 1.6453900709219857, 'no_speech_prob': 0.003945052158087492}, {'id': 46, 'seek': 27216, 'start': 286.8, 'end': 291.76000000000005, 'text': ' offense for himself as an aggressor or for his teammates Wiggins has had a terrific year', 'tokens': [51096, 17834, 337, 3647, 382, 364, 8939, 284, 420, 337, 702, 20461, 343, 6249, 1292, 575, 632, 257, 20899, 1064, 51344], 'temperature': 0.0, 'avg_logprob': -0.23166833482347093, 'compression_ratio': 1.6453900709219857, 'no_speech_prob': 0.003945052158087492}, {'id': 47, 'seek': 27216, 'start': 291.76000000000005, 'end': 296.72, 'text': ' defensively and Golden State the fifth rated defense in the NBA this year oh and Wiggins', 'tokens': [51344, 16468, 356, 293, 13410, 4533, 264, 9266, 22103, 7654, 294, 264, 23890, 341, 1064, 1954, 293, 343, 6249, 1292, 51592], 'temperature': 0.0, 'avg_logprob': -0.23166833482347093, 'compression_ratio': 1.6453900709219857, 'no_speech_prob': 0.003945052158087492}, {'id': 48, 'seek': 29672, 'start': 296.72, 'end': 302.08000000000004, 'text': " with the block of James has to fire it up and it's the side of the backboard great defensive", 'tokens': [50364, 365, 264, 3461, 295, 5678, 575, 281, 2610, 309, 493, 293, 309, 311, 264, 1252, 295, 264, 646, 3787, 869, 16468, 50632], 'temperature': 0.0, 'avg_logprob': -0.17263290209647936, 'compression_ratio': 1.6795774647887325, 'no_speech_prob': 0.019717471674084663}, {'id': 49, 'seek': 29672, 'start': 302.08000000000004, 'end': 307.84000000000003, 'text': ' play from Andrew Wiggins this is a great defensive play coach but in my opinion LeBron lets him off', 'tokens': [50632, 862, 490, 10110, 343, 6249, 1292, 341, 307, 257, 869, 16468, 862, 6560, 457, 294, 452, 4800, 1456, 33, 2044, 6653, 796, 766, 50920], 'temperature': 0.0, 'avg_logprob': -0.17263290209647936, 'compression_ratio': 1.6795774647887325, 'no_speech_prob': 0.019717471674084663}, {'id': 50, 'seek': 29672, 'start': 307.84000000000003, 'end': 312.96000000000004, 'text': " the hook he fades away there's no help coming that's one-on-one beat him on your terms go", 'tokens': [50920, 264, 6328, 415, 32679, 1314, 456, 311, 572, 854, 1348, 300, 311, 472, 12, 266, 12, 546, 4224, 796, 322, 428, 2115, 352, 51176], 'temperature': 0.0, 'avg_logprob': -0.17263290209647936, 'compression_ratio': 1.6795774647887325, 'no_speech_prob': 0.019717471674084663}, {'id': 51, 'seek': 29672, 'start': 312.96000000000004, 'end': 320.16, 'text': ' towards the basket as opposed to fading away from him absolutely Wiggins had a strong finish', 'tokens': [51176, 3030, 264, 8390, 382, 8851, 281, 38644, 1314, 490, 796, 3122, 343, 6249, 1292, 632, 257, 2068, 2413, 51536], 'temperature': 0.0, 'avg_logprob': -0.17263290209647936, 'compression_ratio': 1.6795774647887325, 'no_speech_prob': 0.019717471674084663}, {'id': 52, 'seek': 29672, 'start': 320.16, 'end': 325.20000000000005, 'text': ' to the season especially after the all-star break not only the defense but averaging over 20 per game', 'tokens': [51536, 281, 264, 3196, 2318, 934, 264, 439, 12, 9710, 1821, 406, 787, 264, 7654, 457, 47308, 670, 945, 680, 1216, 51788], 'temperature': 0.0, 'avg_logprob': -0.17263290209647936, 'compression_ratio': 1.6795774647887325, 'no_speech_prob': 0.019717471674084663}, {'id': 53, 'seek': 32520, 'start': 326.0, 'end': 331.68, 'text': ' ball deflected by Caldwell Pope Wiggins guarded by James down the other end knocks down the three', 'tokens': [50404, 2594, 41373, 292, 538, 3511, 67, 6326, 19291, 343, 6249, 1292, 44157, 538, 5678, 760, 264, 661, 917, 40815, 760, 264, 1045, 50688], 'temperature': 0.0, 'avg_logprob': -0.18217295931096664, 'compression_ratio': 1.6816608996539792, 'no_speech_prob': 0.000200264883460477}, {'id': 54, 'seek': 32520, 'start': 332.47999999999996, 'end': 337.76, 'text': " pretty good couple of sequences for Andrew Wiggins to start his play-in game he's had a tremendous", 'tokens': [50728, 1238, 665, 1916, 295, 22978, 337, 10110, 343, 6249, 1292, 281, 722, 702, 862, 12, 259, 1216, 415, 311, 632, 257, 10048, 50992], 'temperature': 0.0, 'avg_logprob': -0.18217295931096664, 'compression_ratio': 1.6816608996539792, 'no_speech_prob': 0.000200264883460477}, {'id': 55, 'seek': 32520, 'start': 337.76, 'end': 343.76, 'text': " year I mean when he's the third most important player like he was in Minnesota the year they", 'tokens': [50992, 1064, 286, 914, 562, 415, 311, 264, 2636, 881, 1021, 4256, 411, 415, 390, 294, 13996, 264, 1064, 436, 51292], 'temperature': 0.0, 'avg_logprob': -0.18217295931096664, 'compression_ratio': 1.6816608996539792, 'no_speech_prob': 0.000200264883460477}, {'id': 56, 'seek': 32520, 'start': 343.76, 'end': 348.56, 'text': " went to the playoffs when he was there it's a perfect role for him I mean he's played exceptional", 'tokens': [51292, 1437, 281, 264, 41142, 562, 415, 390, 456, 309, 311, 257, 2176, 3090, 337, 796, 286, 914, 415, 311, 3737, 19279, 51532], 'temperature': 0.0, 'avg_logprob': -0.18217295931096664, 'compression_ratio': 1.6816608996539792, 'no_speech_prob': 0.000200264883460477}, {'id': 57, 'seek': 32520, 'start': 348.56, 'end': 354.15999999999997, 'text': ' basketball this year particularly the second half of the year Drummond puts it on the floor double', 'tokens': [51532, 11767, 341, 1064, 4098, 264, 1150, 1922, 295, 264, 1064, 40320, 12171, 8137, 309, 322, 264, 4123, 3834, 51812], 'temperature': 0.0, 'avg_logprob': -0.18217295931096664, 'compression_ratio': 1.6816608996539792, 'no_speech_prob': 0.000200264883460477}, {'id': 58, 'seek': 35416, 'start': 354.16, 'end': 360.08000000000004, 'text': ' team back out to Davis shot clock down to three James a three-pointer way off and Draymond bringing', 'tokens': [50364, 1469, 646, 484, 281, 15658, 3347, 7830, 760, 281, 1045, 5678, 257, 1045, 12, 2259, 5106, 636, 766, 293, 2491, 320, 12171, 5062, 50660], 'temperature': 0.0, 'avg_logprob': -0.22880431727359168, 'compression_ratio': 1.564516129032258, 'no_speech_prob': 0.0013669137842953205}, {'id': 59, 'seek': 35416, 'start': 360.08000000000004, 'end': 365.20000000000005, 'text': ' the rebound the Lakers have missed nine of their first 11 from the field Bazemore running gets it', 'tokens': [50660, 264, 31850, 264, 441, 19552, 362, 6721, 4949, 295, 641, 700, 2975, 490, 264, 2519, 42220, 443, 418, 2614, 2170, 309, 50916], 'temperature': 0.0, 'avg_logprob': -0.22880431727359168, 'compression_ratio': 1.564516129032258, 'no_speech_prob': 0.0013669137842953205}, {'id': 60, 'seek': 35416, 'start': 365.20000000000005, 'end': 370.72, 'text': " a loony and loony and a held ball with Anthony Davis I'm just thinking about it think about", 'tokens': [50916, 257, 450, 2526, 293, 450, 2526, 293, 257, 5167, 2594, 365, 15853, 15658, 286, 478, 445, 1953, 466, 309, 519, 466, 51192], 'temperature': 0.0, 'avg_logprob': -0.22880431727359168, 'compression_ratio': 1.564516129032258, 'no_speech_prob': 0.0013669137842953205}, {'id': 61, 'seek': 35416, 'start': 370.72, 'end': 376.32000000000005, 'text': ' your third best player with the ability to average 20 to 25 points you put Klay Thompson with this', 'tokens': [51192, 428, 2636, 1151, 4256, 365, 264, 3485, 281, 4274, 945, 281, 3552, 2793, 291, 829, 591, 8376, 23460, 365, 341, 51472], 'temperature': 0.0, 'avg_logprob': -0.22880431727359168, 'compression_ratio': 1.564516129032258, 'no_speech_prob': 0.0013669137842953205}, {'id': 62, 'seek': 37632, 'start': 376.32, 'end': 384.08, 'text': " unit watch out next year absolutely and I give Steve Kerr a lot of credit he's narrowed his", 'tokens': [50364, 4985, 1159, 484, 958, 1064, 3122, 293, 286, 976, 7466, 20706, 81, 257, 688, 295, 5397, 415, 311, 9432, 292, 702, 50752], 'temperature': 0.0, 'avg_logprob': -0.17144742505303745, 'compression_ratio': 1.5601659751037344, 'no_speech_prob': 0.19671641290187836}, {'id': 63, 'seek': 37632, 'start': 384.08, 'end': 389.76, 'text': " rotation they play eight guys now there's more comfort level they're an older team they're", 'tokens': [50752, 12447, 436, 862, 3180, 1074, 586, 456, 311, 544, 3400, 1496, 436, 434, 364, 4906, 1469, 436, 434, 51036], 'temperature': 0.0, 'avg_logprob': -0.17144742505303745, 'compression_ratio': 1.5601659751037344, 'no_speech_prob': 0.19671641290187836}, {'id': 64, 'seek': 37632, 'start': 389.76, 'end': 396.8, 'text': " experienced you don't go far in the NBA playoffs playing all young guys you saw Klay Thompson there", 'tokens': [51036, 6751, 291, 500, 380, 352, 1400, 294, 264, 23890, 41142, 2433, 439, 2037, 1074, 291, 1866, 591, 8376, 23460, 456, 51388], 'temperature': 0.0, 'avg_logprob': -0.17144742505303745, 'compression_ratio': 1.5601659751037344, 'no_speech_prob': 0.19671641290187836}, {'id': 65, 'seek': 37632, 'start': 396.8, 'end': 405.36, 'text': ' once that injury it changed a lot of plans for the Golden State Warriors James now guarded by', 'tokens': [51388, 1564, 300, 10454, 309, 3105, 257, 688, 295, 5482, 337, 264, 13410, 4533, 40161, 5678, 586, 44157, 538, 51816], 'temperature': 0.0, 'avg_logprob': -0.17144742505303745, 'compression_ratio': 1.5601659751037344, 'no_speech_prob': 0.19671641290187836}, {'id': 66, 'seek': 40536, 'start': 405.36, 'end': 410.40000000000003, 'text': ' Bazemore Wiggins helps out Schroeder good ball movement here Caldwell Pope good look knocks down', 'tokens': [50364, 42220, 443, 418, 343, 6249, 1292, 3665, 484, 2065, 340, 10020, 665, 2594, 3963, 510, 3511, 67, 6326, 19291, 665, 574, 40815, 760, 50616], 'temperature': 0.0, 'avg_logprob': -0.1707863211631775, 'compression_ratio': 1.6483050847457628, 'no_speech_prob': 0.0010322182206436992}, {'id': 67, 'seek': 40536, 'start': 410.40000000000003, 'end': 418.0, 'text': " the three and that's what they want out of that double team I would rather stunt at Anthony Davis", 'tokens': [50616, 264, 1045, 293, 300, 311, 437, 436, 528, 484, 295, 300, 3834, 1469, 286, 576, 2831, 33391, 412, 15853, 15658, 50996], 'temperature': 0.0, 'avg_logprob': -0.1707863211631775, 'compression_ratio': 1.6483050847457628, 'no_speech_prob': 0.0010322182206436992}, {'id': 68, 'seek': 40536, 'start': 418.0, 'end': 423.92, 'text': ' stay at home with Caldwell Pope and make Anthony Davis shoot and make threes you see Schroeder', 'tokens': [50996, 1754, 412, 1280, 365, 3511, 67, 6326, 19291, 293, 652, 15853, 15658, 3076, 293, 652, 258, 4856, 291, 536, 2065, 340, 10020, 51292], 'temperature': 0.0, 'avg_logprob': -0.1707863211631775, 'compression_ratio': 1.6483050847457628, 'no_speech_prob': 0.0010322182206436992}, {'id': 69, 'seek': 40536, 'start': 423.92, 'end': 428.56, 'text': " initially on Steph Curry there'll be a number of players James with the deflection but Wiggins able", 'tokens': [51292, 9105, 322, 31418, 34789, 456, 603, 312, 257, 1230, 295, 4150, 5678, 365, 264, 1060, 5450, 457, 343, 6249, 1292, 1075, 51524], 'temperature': 0.0, 'avg_logprob': -0.1707863211631775, 'compression_ratio': 1.6483050847457628, 'no_speech_prob': 0.0010322182206436992}, {'id': 70, 'seek': 42856, 'start': 428.56, 'end': 436.56, 'text': ' to get it back shot clock down to four Wiggins pull up three and Drummond rips down the rebound', 'tokens': [50364, 281, 483, 309, 646, 3347, 7830, 760, 281, 1451, 343, 6249, 1292, 2235, 493, 1045, 293, 40320, 12171, 367, 2600, 760, 264, 31850, 50764], 'temperature': 0.0, 'avg_logprob': -0.2004831678727094, 'compression_ratio': 1.5798816568047338, 'no_speech_prob': 0.03514043614268303}, {'id': 71, 'seek': 42856, 'start': 436.56, 'end': 441.28000000000003, 'text': ' Drummond one of the premier elite rebounders in the game throughout his career', 'tokens': [50764, 40320, 12171, 472, 295, 264, 12689, 17801, 31850, 433, 294, 264, 1216, 3710, 702, 3988, 51000], 'temperature': 0.0, 'avg_logprob': -0.2004831678727094, 'compression_ratio': 1.5798816568047338, 'no_speech_prob': 0.03514043614268303}, {'id': 72, 'seek': 42856, 'start': 444.64, 'end': 447.12, 'text': ' Caldwell Pope off balance', 'tokens': [51168, 3511, 67, 6326, 19291, 766, 4772, 51292], 'temperature': 0.0, 'avg_logprob': -0.2004831678727094, 'compression_ratio': 1.5798816568047338, 'no_speech_prob': 0.03514043614268303}, {'id': 73, 'seek': 42856, 'start': 452.8, 'end': 456.32, 'text': ' James goes down the lane the runner and draws the foul on Bazemore', 'tokens': [51576, 5678, 1709, 760, 264, 12705, 264, 24376, 293, 20045, 264, 23491, 322, 42220, 443, 418, 51752], 'temperature': 0.0, 'avg_logprob': -0.2004831678727094, 'compression_ratio': 1.5798816568047338, 'no_speech_prob': 0.03514043614268303}, {'id': 74, 'seek': 45856, 'start': 459.04, 'end': 468.4, 'text': " well they get the switch and then they double and they full rotate that's a long closeout by Wiggins", 'tokens': [50388, 731, 436, 483, 264, 3679, 293, 550, 436, 3834, 293, 436, 1577, 13121, 300, 311, 257, 938, 1998, 346, 538, 343, 6249, 1292, 50856], 'temperature': 0.0, 'avg_logprob': -0.31558074951171877, 'compression_ratio': 1.4845360824742269, 'no_speech_prob': 8.219588198699057e-05}, {'id': 75, 'seek': 45856, 'start': 469.12, 'end': 475.84000000000003, 'text': ' again I would have rather stunted off of Caldwell Pope and made Anthony Davis shoot the long ball', 'tokens': [50892, 797, 286, 576, 362, 2831, 342, 19015, 766, 295, 3511, 67, 6326, 19291, 293, 1027, 15853, 15658, 3076, 264, 938, 2594, 51228], 'temperature': 0.0, 'avg_logprob': -0.31558074951171877, 'compression_ratio': 1.4845360824742269, 'no_speech_prob': 8.219588198699057e-05}, {'id': 76, 'seek': 45856, 'start': 476.72, 'end': 483.76, 'text': ' and Mike did we have starting lineups earlier yes I wish they were sponsored by Taco Bell', 'tokens': [51272, 293, 6602, 630, 321, 362, 2891, 1622, 7528, 3071, 2086, 286, 3172, 436, 645, 16621, 538, 37992, 11485, 51624], 'temperature': 0.0, 'avg_logprob': -0.31558074951171877, 'compression_ratio': 1.4845360824742269, 'no_speech_prob': 8.219588198699057e-05}, {'id': 77, 'seek': 48376, 'start': 483.76, 'end': 486.08, 'text': ' and I could have said sponsored by Taco Fall', 'tokens': [50364, 293, 286, 727, 362, 848, 16621, 538, 37992, 7465, 50480], 'temperature': 0.0, 'avg_logprob': -0.22918180056980678, 'compression_ratio': 1.4074074074074074, 'no_speech_prob': 0.02884407341480255}, {'id': 78, 'seek': 48376, 'start': 488.15999999999997, 'end': 492.96, 'text': " I'm surprised you waited so long to take your first shot man you didn't come up for breath so I", 'tokens': [50584, 286, 478, 6100, 291, 15240, 370, 938, 281, 747, 428, 700, 3347, 587, 291, 994, 380, 808, 493, 337, 6045, 370, 286, 50824], 'temperature': 0.0, 'avg_logprob': -0.22918180056980678, 'compression_ratio': 1.4074074074074074, 'no_speech_prob': 0.02884407341480255}, {'id': 79, 'seek': 48376, 'start': 492.96, 'end': 499.84, 'text': " I was I've been sitting on that James hits the free throw but congratulations to you on", 'tokens': [50824, 286, 390, 286, 600, 668, 3798, 322, 300, 5678, 8664, 264, 1737, 3507, 457, 13568, 281, 291, 322, 51168], 'temperature': 0.0, 'avg_logprob': -0.22918180056980678, 'compression_ratio': 1.4074074074074074, 'no_speech_prob': 0.02884407341480255}]

def getTranscription(audioPath):
    with open(audioPath, 'rb') as audio_file:
        transcript = client.audio.transcriptions.create(
              model="whisper-1",
              file=audio_file,
              response_format="verbose_json"
          )
        print(transcript.segments)
    return

def main():
    # chunked_audios = chunk_audio('../files/10-mins.mp3')
    transcriptions = []

    # chunk the file paths -- 10 per time
    # chunks = sampleChunks
    # chunked_chunks = [chunks[i:i + 10] for i in range(0, len(chunks), 10)]

    # for smaller_chunk in chunked_chunks:
        
    # # parallel whisper call
    # # put the transcriptions to an object
    
    # # ask GPT to rank it in terms of interestingness

    for audio in oneChunk:
        with open(audio, 'rb') as audio_file:
          transcript = client.audio.transcriptions.create(
              model="whisper-1",
              file=audio_file,
              response_format="verbose_json"
          )
          # start_time = int(audio.split('_')[1].replace('.mp3', ''))
          # end_time = start_time + 10
          transcriptions.append({
              # 'start': start_time,
              # 'end': end_time,
              'text': transcript
          })
    print(transcriptions)


if __name__ == "__main__":
  print()
